# Exploit

This directory provides an exploit for every vulnerability of the service.

## Dependencies

The exploits scripts use `pipenv` to install the required dependencies. In order to do so yourself, install them using:

	pipenv install

## Scripts

* `exploit1.py` - SQLi to read the personal notes of all users (`**Flag Store 1, Vulnerability 1**`)
* `exploit2.py` - JWT Algorithm Confusion to login as a user by manipulating the JWT correctly (`**Flag Store1, Vulnerability 2**`)
* `exploit3.py` - oAuth Login Bypass to login into an arbitrary account (`**Flag Store1, Vulnerability 3**`)
* `exploit4.py` - Path Traversal with faulty sanitization (`**Flag Store 2, Vulnerability 1**`) 
* `exploit5.py` - SSRF with an open redirect to send custom GET-requests to the webserver containing arbitrary http-endpoints (`**Flag Store 2, Vulnerability 2**`)

## Arguments

There are mostly two input parameters for each script:

* `IP of the service` will be known during competition or `127.0.0.1` if you're testing locally
* `Flag ID` should be provided during competition or you can run the checkers in `/checkers` to dispatch them yourself. In case of our service, the flag ID is either users `username` or `email`

## Run

To run the exploits use:

	pipenv run python exploit1.py [SERVICE-IP-ADDRESS] [USERNAME/FLAG-ID]
	pipenv run python exploit2.py [SERVICE-IP-ADDRESS] [USERNAME/FLAG-ID]
	pipenv run python exploit3.py [SERVICE-IP-ADDRESS] [USERNAME/FLAG-ID]
	pipenv run python exploit4.py [SERVICE-IP-ADDRESS] [EMAIL/FLAG-ID]
	pipenv run python exploit5.py [SERVICE-IP-ADDRESS] [EMAIL/FLAG-ID]
